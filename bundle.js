(()=>{var t={673:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>a});var s=i(645),n=i.n(s)()((function(t){return t[1]}));n.push([t.id,".button{width:207px;height:36px;color:#388bb1;background:#e7e7e7;box-shadow:0px 3px 5px rgba(0,0,0,.2),0px 1px 18px rgba(0,0,0,.12),0px 6px 10px rgba(0,0,0,.14);border-radius:4px}",""]);const a=n},741:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>a});var s=i(645),n=i.n(s)()((function(t){return t[1]}));n.push([t.id,".link{display:block;color:#faebd7}",""]);const a=n},52:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>a});var s=i(645),n=i.n(s)()((function(t){return t[1]}));n.push([t.id,".icon{background-repeat:no-repeat}.menu-icon{width:60px;height:60px}",""]);const a=n},299:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>a});var s=i(645),n=i.n(s)()((function(t){return t[1]}));n.push([t.id,".menu__item{display:flex;flex-direction:column;justify-content:center;align-items:center;text-decoration:none;flex-grow:1}.current{filter:drop-shadow(2px 4px 5px black);-webkit-filter:drop-shadow(2px 4px 5px black)}",""]);const a=n},80:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>a});var s=i(645),n=i.n(s)()((function(t){return t[1]}));n.push([t.id,".menu{list-style:none;display:flex;width:288px;color:#e7e7e7}",""]);const a=n},64:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>f});var s=i(645),n=i.n(s),a=i(667),r=i.n(a),o=i(781),c=i(777),h=i(41),d=i(556),l=n()((function(t){return t[1]})),u=r()(o),p=r()(c),g=r()(h),m=r()(d);l.push([t.id,'.grey-modal{opacity:.7;background-color:#acacac;position:fixed;top:0;left:0;width:100%;height:100%}.modal-content{display:flex;flex-direction:column-reverse;justify-content:space-evenly;align-items:center;opacity:1;position:fixed;width:75%;left:50%;top:30%;margin-left:-37.5%;height:100px;background-color:#e7e7e7;border:solid 4px #000;border-color:#000;z-index:2}.hidden{display:none}.car-svg{-webkit-transform:scaleX(-1);transform:scaleX(-1)}.car-svg::before{content:"";width:1920px;height:3px}.car-container::after{display:block;content:"";background:repeating-linear-gradient(to right, #fffafa, #8b8e91 10px);width:90%;height:5px;position:relative;bottom:30px}.finish-flag{display:block;width:50px;height:50px;position:relative;top:140px;left:80%;background-image:url('+u+")}.car-container__info{display:flex}.car-track__animation-controls{margin-bottom:15px}.car-track__animation-controls .button{width:50px}.page{padding-left:30px}.trophy-icon{background-image:url("+p+")}.garage-icon{background-image:url("+g+")}.header{display:flex;justify-content:center;background:linear-gradient(#6a9af1, #3742e0);margin-bottom:60px}.app{min-height:100vh;background-size:cover;background-image:url("+m+')}.car-name{font-family:"Open Sans";color:#e7e7e7}.form__inputs-wrapper{display:flex;margin-right:15px}.form .input{margin-right:5px}.garage__controls{display:flex;justify-content:center}.garage__controls .button{width:307px;height:72px;background:#04aa6d;color:#faebd7}.page__controls{margin-bottom:30px}.page__controls_random-cars{margin-bottom:5px}.form__car-input_text{padding:12px;border:1px solid #acacac;border-radius:4px;box-sizing:border-box}.form__car-input_control{background-color:#04aa6d;color:#faebd7;padding:12px 20px;border:none;border-radius:4px;cursor:pointer;float:right}.form__car-input_color{-webkit-appearance:none;border:none;background:#faebd7;width:41px;height:41px;overflow:hidden;outline:none;cursor:inherit}.car-form{display:flex;align-items:center;margin-bottom:30px}@keyframes slide{from{margin-left:0%}to{margin-left:80%}}.table{font-family:"Lucida Sans Unicode","Lucida Grande",Sans-Serif;font-size:14px;background:snow;text-align:center;border-collapse:collapse;color:#353333}.table .table__head{padding:8px 10px;font-weight:normal;border-bottom:2px solid #f5e1a6;border-right:20px solid snow;border-left:20px solid snow;cursor:pointer}.table .table__head:first-child{border-left:none}.table .table__col{border-right:20px solid snow;border-left:20px solid snow;padding:12px 10px;text-align:center;color:#8b8e91}.table .table__col:first-child{border-left:none}.page__name,.page__number,.form-explanation{color:#faebd7;font-family:Poppins}.winner-page{display:flex;flex-direction:column;align-items:center}.button:disabled{background-color:#acacac}',""]);const f=l},645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=t(e);return e[2]?"@media ".concat(e[2]," {").concat(i,"}"):i})).join("")},e.i=function(t,i,s){"string"==typeof t&&(t=[[null,t,""]]);var n={};if(s)for(var a=0;a<this.length;a++){var r=this[a][0];null!=r&&(n[r]=!0)}for(var o=0;o<t.length;o++){var c=[].concat(t[o]);s&&n[c[0]]||(i&&(c[2]?c[2]="".concat(i," and ").concat(c[2]):c[2]=i),e.push(c))}},e}},667:t=>{"use strict";t.exports=function(t,e){return e||(e={}),"string"!=typeof(t=t&&t.__esModule?t.default:t)?t:(/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t)}},679:(t,e,i)=>{var s=i(379),n=i(673);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.id,n,""]]);s(n,{insert:"head",singleton:!1}),t.exports=n.locals||{}},206:(t,e,i)=>{var s=i(379),n=i(741);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.id,n,""]]);s(n,{insert:"head",singleton:!1}),t.exports=n.locals||{}},806:(t,e,i)=>{var s=i(379),n=i(52);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.id,n,""]]);s(n,{insert:"head",singleton:!1}),t.exports=n.locals||{}},981:(t,e,i)=>{var s=i(379),n=i(299);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.id,n,""]]);s(n,{insert:"head",singleton:!1}),t.exports=n.locals||{}},902:(t,e,i)=>{var s=i(379),n=i(80);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.id,n,""]]);s(n,{insert:"head",singleton:!1}),t.exports=n.locals||{}},844:(t,e,i)=>{var s=i(379),n=i(64);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.id,n,""]]);s(n,{insert:"head",singleton:!1}),t.exports=n.locals||{}},379:(t,e,i)=>{"use strict";var s,n=function(){var t={};return function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}t[e]=i}return t[e]}}(),a=[];function r(t){for(var e=-1,i=0;i<a.length;i++)if(a[i].identifier===t){e=i;break}return e}function o(t,e){for(var i={},s=[],n=0;n<t.length;n++){var o=t[n],c=e.base?o[0]+e.base:o[0],h=i[c]||0,d="".concat(c," ").concat(h);i[c]=h+1;var l=r(d),u={css:o[1],media:o[2],sourceMap:o[3]};-1!==l?(a[l].references++,a[l].updater(u)):a.push({identifier:d,updater:m(u,e),references:1}),s.push(d)}return s}function c(t){var e=document.createElement("style"),s=t.attributes||{};if(void 0===s.nonce){var a=i.nc;a&&(s.nonce=a)}if(Object.keys(s).forEach((function(t){e.setAttribute(t,s[t])})),"function"==typeof t.insert)t.insert(e);else{var r=n(t.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(e)}return e}var h,d=(h=[],function(t,e){return h[t]=e,h.filter(Boolean).join("\n")});function l(t,e,i,s){var n=i?"":s.media?"@media ".concat(s.media," {").concat(s.css,"}"):s.css;if(t.styleSheet)t.styleSheet.cssText=d(e,n);else{var a=document.createTextNode(n),r=t.childNodes;r[e]&&t.removeChild(r[e]),r.length?t.insertBefore(a,r[e]):t.appendChild(a)}}function u(t,e,i){var s=i.css,n=i.media,a=i.sourceMap;if(n?t.setAttribute("media",n):t.removeAttribute("media"),a&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleSheet)t.styleSheet.cssText=s;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(s))}}var p=null,g=0;function m(t,e){var i,s,n;if(e.singleton){var a=g++;i=p||(p=c(e)),s=l.bind(null,i,a,!1),n=l.bind(null,i,a,!0)}else i=c(e),s=u.bind(null,i,e),n=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(i)};return s(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;s(t=e)}else n()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=(void 0===s&&(s=Boolean(window&&document&&document.all&&!window.atob)),s));var i=o(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var s=0;s<i.length;s++){var n=r(i[s]);a[n].references--}for(var c=o(t,e),h=0;h<i.length;h++){var d=r(i[h]);0===a[d].references&&(a[d].updater(),a.splice(d,1))}i=c}}}},556:(t,e,i)=>{"use strict";t.exports=i.p+"2e8fc8943960e1329bfc.jpg"},781:(t,e,i)=>{"use strict";t.exports=i.p+"34a82fa702bef2da9c97.svg"},41:(t,e,i)=>{"use strict";t.exports=i.p+"8cfa527a62f68d4599ee.svg"},777:(t,e,i)=>{"use strict";t.exports=i.p+"83707400fdbec62e2e2a.svg"}},e={};function i(s){var n=e[s];if(void 0!==n)return n.exports;var a=e[s]={id:s,exports:{}};return t[s](a,a.exports,i),a.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;i.g.importScripts&&(t=i.g.location+"");var e=i.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var s=e.getElementsByTagName("script");s.length&&(t=s[s.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=t})(),(()=>{"use strict";i(844);class t{constructor(t="div",e=[],i=""){this.node=document.createElement(t),this.node.classList.add(...e),this.node.innerText=i}insertChild(t){this.node.appendChild(t.getNode())}insertChildBefore(t){this.node.prepend(t.getNode())}insertChildsBefore(t){t.forEach((t=>{this.insertChildBefore(t)}))}insertChilds(t){t.forEach((t=>{this.insertChild(t)}))}getNode(){return this.node}addClass(t){this.node.classList.add(t)}setContent(t){this.node.innerText=t}setAttribute(t,e){this.node.setAttribute(t,e)}removeAttribute(t){this.node.removeAttribute(t)}toggleClass(t){this.node.classList.toggle(t)}setBgImage(t){this.node.style.backgroundImage=`url(${t})`}addListener(t,e,i=!1){this.node.addEventListener(t,e,i)}}i(902),i(981),i(206);class e extends t{constructor(t,e,i){super("a",["link"],t),this.onClick=()=>{},this.setAttribute("href",e),this.onClick=i,this.node.onclick=()=>this.onClick?.()}}i(806);class s extends t{constructor(t){super("div",["icon",...t],"")}}class n extends t{constructor(t,i,n){super("li",["menu__item"],""),this.href=i,this.link=new e(t,i),this.icon=new s(["menu-icon",n]),this.insertChild(this.icon),this.insertChild(this.link)}getHref(){return this.href}}class a extends t{constructor(){super("ul",["menu"],""),this.items=[],this.items.push(new n("Garage","#garage","garage-icon"),new n("Winners","#winners","trophy-icon")),this.items.map((t=>this.insertChild(t)))}setCurrent(t){this.items.find((e=>e.getHref()===t)).toggleClass("current")}}i(679);class r extends t{constructor(t,e,i=(()=>{})){super("button",["button",...e||[]],t),this.onClick=()=>{},this.node.onclick=t=>{t.preventDefault(),i()}}}class o extends t{constructor(e,i){super("div",["modal"]),this.modalWrapper=new t("div",["grey-modal"]),this.modalContent=e,this.modalContent.addClass("modal-content"),this.insertChild(this.modalContent),this.insertChild(this.modalWrapper),i&&i.appendChild(this.node)}toggleModal(){this.toggleClass("hidden")}getModalWrapper(){return this.modalWrapper}}class c extends t{constructor(t){super("div",[],t),this.okButtonHandler=()=>{this.node.innerText="",this.okButton=new r("ok",[],this.okButtonHandler.bind(this)),this.insertChild(this.okButton),this.onOkClick?.()},this.node.innerText=t,this.okButton=new r("ok",[],this.okButtonHandler.bind(this)),this.insertChild(this.okButton)}close(){this.toggleClass("hidden")}}class h extends t{constructor(t,e,i,s){super("input",["input",...e],""),this.input=this.node,this.setAttributes(t,i,s),this.createListeners()}setHandler(t){this.onInput=t}checkValidation(){this.onInput&&(this.input.reportValidity(),this.isValid=this.onInput(this.input),this.input.classList.add(this.isValid?"valid":"invalid"),this.input.classList.remove(this.isValid?"invalid":"valid"))}setAttributes(t,e,i){this.setAttribute("type",t),this.setAttribute("placeholder",e),i&&this.setAttribute("value",i.toString())}createListeners(){this.input.addEventListener("input",(()=>{this.checkValidation()})),this.input.addEventListener("invalid",(()=>{}),!1)}getValue(){return this.input.value}getNode(){return this.node}setValue(t){this.input.value=t}}class d extends t{constructor(t){super("form",["form",...t],""),this.inputs=[],this.setAttribute("action",""),this.createFormComponents(),this.inputs.push(this.carNameInput,this.colorInput),this.createUI(),this.addUserInputListeners()}addUserInputListeners(){this.reset.addListener("click",(t=>{t.preventDefault(),this.resetForm()})),this.submit.addListener("click",(t=>{t.preventDefault();const[e,i]=[...this.inputs.map((t=>t.getValue()))];this?.onSubmit({name:e,color:i}),this.resetForm()}))}onValidate(){this.inputs.every((t=>t.isValid))&&this.submit.removeAttribute("disabled")}resetForm(){this.carNameInput.getNode().value="",this.colorInput.getNode().value="#000000"}createFormComponents(){this.carNameInput=new h("text",["form__car-input_text"],"Car name"),this.colorInput=new h("color",["form__car-input_color"]),this.reset=new h("reset",["form__car-input_control"],"","Reset"),this.submit=new h("submit",["form__car-input_control"],"","Create")}createUI(){const e=new t("div",["form__inputs-wrapper"]),i=new t("div",["form__controls"]);e.insertChilds(this.inputs),i.insertChilds([this.reset,this.submit]),this.insertChilds([e,i])}}class l{constructor(){this.start=()=>{this.interval=setInterval(this.tick,1e3)},this.stop=()=>{clearInterval(this.interval)},this.reset=()=>{this.stop(),this.minutes=0,this.seconds=0,this.currentTimeInSeconds=0},this.tick=()=>{this.currentTimeInSeconds+=1,this.onTick&&this.onTick(this.getTime())},this.minutes=0,this.seconds=0,this.currentTimeInSeconds=0}getTime(){return this.minutes=Math.floor(this.currentTimeInSeconds/60),this.seconds=this.currentTimeInSeconds-60*this.minutes,{minutes:this.minutes,seconds:this.seconds}}getSeconds(){return this.currentTimeInSeconds}}class u extends t{constructor(){super("div",["timer"]),this.setContent("00:00")}setTime(t){this.setContent(t)}}class p{constructor(){this.isRunning=!0,this.view=new u,this.model=new l,this.model.onTick=this.updateView.bind(this)}getCurrentTime(t){return this.currentTime=`${t.minutes<=9?`0${t.minutes}`:t.minutes}:${t.seconds<=9?`0${t.seconds}`:t.seconds}`,this.currentTime}getTime(){return this.getCurrentTime(this.model.getTime())}updateView(t){this.view.setTime(this.getCurrentTime(t))}start(t){setTimeout((()=>{this.model.start()}),t)}getNode(){return this.view.getNode()}toggle(){this.isRunning?(this.isRunning=!1,this.model.stop()):(this.isRunning=!0,this.model.start())}reset(){this.model.reset()}getSeconds(){return this.model.getSeconds()}}class g{constructor(){this.currentPage=1}async checkPaginationButtons(){await this.getCount()/this.paginationLimit<=this.currentPage?this.nextPageButton.setAttribute("disabled","disabled"):this.nextPageButton.removeAttribute("disabled"),1===this.currentPage?this.previousPageButton.setAttribute("disabled","disabled"):this.previousPageButton.removeAttribute("disabled")}}const m="https://async-race-game.herokuapp.com/garage";async function f(t,e=7){const i=await fetch(`${m}?_page=${t}&_limit=${e}`);return{items:await i.json(),count:i.headers.get("X-Total-Count")}}async function b(t){return(await fetch(`${m}/${t}`)).json()}async function w(t){return(await fetch(m,{method:"POST",body:JSON.stringify(t),headers:{"Content-type":"application/json"}})).json()}const C="https://async-race-game.herokuapp.com/winners";async function v(t,e=10,i,s){const n=await fetch(`${C}?_page=${t}&limit=${e}${function(t,e){return t&&e?`&_sort=${t}&_order=${e}`:""}(i,s)}`);return{items:await n.json(),count:n.headers.get("X-Total-Count")}}const x=["Ford","BMW","Jeep","Volvo","Opel","Jiguli","Ferrari","Mitsubishi","Skoda","Belaz"],y=["НЕзбагОЙный","P a F F o S S H H ы Й","ecl!pse ","Anime","TaTaPuH ","NaGiB4Uk","ApAsNыЙ","gopSTOP","gonschik","piton"];function _(t){return Math.floor(Math.random()*t)}class k{constructor(){this.getCarsFunc=f}async getCarsCount(t=1){return parseInt((await this.getCarsFunc(t,7)).count,10)}}class T extends k{static async createWinner(t,e,i){const s=(await v(t)).items.find((t=>t.id===e.getId()));void 0===s?async function(t){(await fetch(C,{method:"POST",body:JSON.stringify(t),headers:{"Content-type":"application/json"}})).json()}({id:e.getId(),wins:1,time:i}):async function(t,e){(await fetch(`${C}/${t}`,{method:"PUT",body:JSON.stringify(e),headers:{"Content-type":"application/json"}})).json()}(e.getId(),{wins:s.wins+=1,time:s.time>i?i:s.time})}static async сreateCars(){for(let t=0;t<100;t+=1)w({name:`${x[_(x.length)]} ${y[_(y.length)]}`,color:`#${_(16**6).toString(16)}`})}static createCar(t,e){w({name:t,color:e})}}const B="https://async-race-game.herokuapp.com/engine";class P extends t{constructor(e,i){super("div",["car-container"]);const s=new t("div",["car-container__info"]);this.carImage=document.createElement("svg"),this.carImage.style.fill=i,this.carImage.innerHTML='\n<svg version="1.1" class="car-svg" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\nwidth="98.967px" height="98.967px" viewBox="0 0 98.967 98.967"\nxml:space="preserve">\n<g>\n <path d="M17.275,52.156c-4.124,0-7.468,3.343-7.468,7.468c0,0.318,0.026,0.631,0.066,0.938c0.463,3.681,3.596,6.528,7.401,6.528\n   c3.908,0,7.112-3.004,7.437-6.83c0.017-0.209,0.031-0.422,0.031-0.637C24.743,55.499,21.4,52.156,17.275,52.156z M13.537,56.81\n   l1.522,1.523c-0.118,0.203-0.211,0.422-0.271,0.656h-2.146C12.752,58.177,13.063,57.435,13.537,56.81z M12.632,60.282h2.163\n   c0.061,0.23,0.151,0.448,0.271,0.648l-1.526,1.525C13.067,61.835,12.749,61.093,12.632,60.282z M16.629,64.263\n   c-0.809-0.113-1.544-0.43-2.166-0.899l1.518-1.519c0.2,0.117,0.419,0.203,0.648,0.263V64.263z M16.629,57.14\n   c-0.235,0.062-0.455,0.154-0.66,0.275l-1.521-1.521c0.625-0.475,1.367-0.789,2.181-0.902V57.14z M17.922,54.99\n   c0.814,0.113,1.557,0.429,2.181,0.903l-1.52,1.521c-0.204-0.121-0.426-0.213-0.66-0.275L17.922,54.99L17.922,54.99z\n    M17.922,64.261v-2.152c0.23-0.061,0.447-0.146,0.647-0.264l1.519,1.519C19.466,63.833,18.73,64.148,17.922,64.261z\n    M21.014,62.462l-1.531-1.533c0.12-0.201,0.217-0.416,0.278-0.646h2.146C21.793,61.091,21.488,61.839,21.014,62.462z\n    M19.764,58.989c-0.061-0.234-0.153-0.453-0.271-0.656l1.524-1.523c0.471,0.625,0.782,1.367,0.894,2.18H19.764z"/>\n <path d="M79.284,52.156c-4.124,0-7.468,3.343-7.468,7.468c0,0.318,0.026,0.631,0.066,0.938c0.463,3.681,3.596,6.528,7.4,6.528\n   c3.908,0,7.112-3.004,7.438-6.83c0.017-0.209,0.031-0.422,0.031-0.637C86.753,55.499,83.409,52.156,79.284,52.156z M75.546,56.81\n   l1.521,1.523c-0.118,0.203-0.211,0.422-0.271,0.656H74.65C74.761,58.177,75.072,57.435,75.546,56.81z M74.642,60.282h2.163\n   c0.061,0.23,0.151,0.448,0.271,0.648l-1.525,1.525C75.076,61.835,74.757,61.093,74.642,60.282z M78.638,64.263\n   c-0.809-0.113-1.544-0.43-2.166-0.899l1.518-1.519c0.2,0.117,0.419,0.203,0.648,0.263V64.263z M78.638,57.14\n   c-0.235,0.062-0.455,0.154-0.66,0.275l-1.521-1.521c0.625-0.475,1.366-0.789,2.181-0.902V57.14z M79.932,54.99\n   c0.814,0.113,1.557,0.429,2.181,0.903l-1.521,1.521c-0.204-0.121-0.426-0.215-0.66-0.275V54.99z M79.932,64.261v-2.152\n   c0.23-0.061,0.447-0.146,0.647-0.264l1.519,1.519C81.476,63.833,80.739,64.148,79.932,64.261z M83.023,62.462l-1.531-1.531\n   c0.12-0.202,0.218-0.416,0.278-0.647h2.146C83.802,61.091,83.498,61.839,83.023,62.462z M81.773,58.989\n   c-0.061-0.234-0.152-0.453-0.271-0.656l1.523-1.523c0.472,0.625,0.782,1.367,0.895,2.18H81.773z"/>\n <path d="M97.216,48.29v-5.526c0-0.889-0.646-1.642-1.524-1.779c-2.107-0.33-5.842-0.953-7.52-1.47\n   c-2.406-0.742-11.702-4.678-14.921-5.417c-3.22-0.739-17.738-4.685-31.643,0.135c-2.353,0.815-12.938,5.875-19.162,8.506\n   c-1.833,0.04-19.976,3.822-20.942,6.414c-0.966,2.593-1.269,3.851-1.447,4.509c-0.178,0.658,0,3.807,1.348,6\n   c1.374,0.777,4.019,1.299,7.077,1.649c-0.035-0.187-0.073-0.371-0.097-0.56c-0.053-0.404-0.078-0.773-0.078-1.125\n   c0-4.945,4.022-8.969,8.968-8.969s8.968,4.023,8.968,8.969c0,0.254-0.017,0.506-0.036,0.754c-0.047,0.555-0.147,1.094-0.292,1.613\n   c0.007,0,0.024,0,0.024,0l44.516-0.896c-0.02-0.115-0.046-0.229-0.061-0.346c-0.053-0.402-0.078-0.772-0.078-1.125\n   c0-4.945,4.022-8.968,8.968-8.968c4.946,0,8.969,4.022,8.969,8.968c0,0.019-0.002,0.035-0.003,0.053l0.19-0.016l7.611-1.433\n   c0,0,2.915-1.552,2.915-5.822C98.967,49.56,97.216,48.29,97.216,48.29z M53.057,43.051L36.432,43.56\n   c0.306-2.491-1.169-3.05-1.169-3.05c6.609-5.999,19.929-6.202,19.929-6.202L53.057,43.051z M71.715,42.29l-15.15,0.509l1.373-8.49\n   c7.83-0.102,12.303,1.626,12.303,1.626l2.237,3.61L71.715,42.29z M80.256,42.238h-4.221l-4.22-5.795\n   c3.166,1.26,5.7,2.502,7.209,3.287C79.94,40.206,80.44,41.223,80.256,42.238z"/>\n</g>\n</svg>',this.name=e,this.color=i,this.carName=new t("label",["car-name"],e),this.carNameUpdate=new h("text",["task__input","hidden"]),this.carColorUpdate=new h("color",["task__input","hidden"]),this.carNameUpdate.setValue(e),this.carColorUpdate.setValue(i),s.insertChilds([this.carName,this.carNameUpdate,this.carColorUpdate]),this.node.append(s.getNode()),this.node.append(this.carImage)}setColor(t){this.color=t,this.carImage.style.fill=t}setName(t){this.name=t,this.carName.setContent(t)}getName(){return this.name}getColor(){return this.color}startAnimation(t){this.carImage.style.animationName="slide",this.carImage.style.animationDuration=t,this.carImage.style.animationPlayState="running",this.carImage.style.animationFillMode="forwards"}stopAnimation(){this.carImage.style.animation=""}pauseAnimation(){this.carImage.style.animationPlayState="paused"}setUpdateMode(){this.carName.toggleClass("hidden"),this.carNameUpdate.toggleClass("hidden"),this.carColorUpdate.toggleClass("hidden")}getSVGInHTML(){return this.carImage.outerHTML}}class S extends t{constructor(e,i,n){super("div",["car-track"]),this.id=n,this.car=new P(e,i),this.startButton=new r("Start",["start-button"],this.animateCar.bind(this)),this.stopButton=new r("Stop",["stop-button"],this.stopCarAnimation.bind(this)),this.stopButton.setAttribute("disabled","disabled"),this.updateButton=new r("Update",["update-button","task__edit-btn"],this.editCar.bind(this)),this.deleteButton=new r("Delete",["delete-button"],this.deleteCar.bind(this));const a=new s(["finish-flag"]),o=new t("div",["car-track__animation-controls"]);o.insertChilds([this.startButton,this.stopButton]),this.insertChilds([a,o,this.car,this.deleteButton,this.updateButton])}editCar(){this.car.setUpdateMode(),this.updateButton.getNode().remove(),this.updateButton=new r("Submit",["task__edit-btn"],this.submit.bind(this)),this.node.append(this.updateButton.getNode())}submit(){this.car.setUpdateMode(),this.car.setName(this.car.carNameUpdate.getValue()),this.car.setColor(this.car.carColorUpdate.getValue()),this.updateButton.getNode().remove(),this.updateButton=new r("Update",["task__edit-btn"],this.editCar.bind(this)),this.node.append(this.updateButton.getNode()),this.submitCar()}async updateCar(){this.editCar()}async submitCar(){await async function(t,e){return(await fetch(`${m}/${t}`,{method:"PUT",body:JSON.stringify(e),headers:{"Content-type":"application/json"}})).json()}(this.id,{name:this.car.getName(),color:this.car.getColor()})}deleteCar(){!async function(t){(await v()).items.find((e=>e.id===t))&&(await fetch(`${C}/${t}`,{method:"DELETE"})).json()}(this.id),async function(t){(await fetch(`${m}/${t}`,{method:"DELETE"})).json()}(this.id),this.node.remove(),this.onUpdate()}setColor(t){this.car.setColor(t)}async animateCar(){const t=await async function(t){return(await fetch(`${B}/?id=${t}&status=started`)).json()}(this.id);return this.car.startAnimation(t.distance/t.velocity*2+"ms"),this.stopButton.removeAttribute("disabled"),this.startButton.setAttribute("disabled","disabled"),new Promise((t=>async function(t){const e=await fetch(`${B}?id=${t}&status=drive`).catch();return 200!==e.status?{success:!1}:{...await e.json()}}(this.id).then((e=>{e.success?t(this):this.pauseAnimation()})).catch()))}async stopCarAnimation(){await async function(t){return(await fetch(`${B}/?id=${t}&status=stopped`)).json()}(this.id),this.car.stopAnimation(),this.startButton.removeAttribute("disabled"),this.stopButton.setAttribute("disabled","disabled")}pauseAnimation(){this.car.pauseAnimation()}setOnUpdate(t){this.onUpdate=t}getCar(){return this.car}getId(){return this.id}}class M extends k{constructor(){super(...arguments),this.carTracks=[]}async getCars(t){return this.carTracks=[],(await f(t)).items.forEach((t=>this.carTracks.push(new S(t.name,t.color,t.id)))),this.carTracks}}class N extends t{constructor(t,e,i,s){super("div",["garage"]),this.carOnUpdate=s,this.onRaceStart=t,this.onRaceEnd=e,this.onPaginate=i,this.model=new M,this.raceButton=new r("Start Race",[],this.animateAllCars.bind(this)),this.stopButton=new r("Stop Race",[],this.stopAllCars.bind(this))}async createGarage(e){this.stopButton.setAttribute("disabled","disabled"),this.node.innerHTML="",this.onPaginate();const i=new t("h2",["page__name"],`Garage (${await this.model.getCarsCount()})`),s=new t("h3",["page__number"],`Page #(${e})`),n=await this.model.getCars(e),a=new t("div",["garage__controls"]);a.insertChilds([this.stopButton,this.raceButton]),n.forEach((t=>{t.setOnUpdate(this.updateGarage.bind(this)),this.insertChildBefore(t)})),this.insertChildsBefore([a,s,i])}async animateAllCars(){this.toggleRaceMode(),this.onRaceStart(),Promise.any(this.model.carTracks.map((async t=>t.animateCar()))).then((t=>this.onRaceEnd(t))).catch()}async stopAllCars(){this.toggleDefaultMode(),this.model.carTracks.forEach((t=>t.stopCarAnimation()))}updateGarage(){this.node.innerHTML="",this.carOnUpdate()}toggleRaceMode(){this.stopButton.removeAttribute("disabled"),this.raceButton.setAttribute("disabled","disabled")}toggleDefaultMode(){this.raceButton.removeAttribute("disabled"),this.stopButton.setAttribute("disabled","disabled")}}class A extends g{constructor(t){super(),this.paginationLimit=7,this.model=new T,this.handleRaceEnd=async t=>{T.createWinner(this.currentPage,t,this.timer.getSeconds()),this.createWinPopup(`Первым пришёл водитель ${t.getCar().getName()} за ${this.timer.getTime()}`),this.toggleModal(),this.timer.reset()},this.root=t,this.garage=new N(this.startTimer.bind(this),this.handleRaceEnd.bind(this),this.checkPaginationButtons.bind(this),this.updateGarage.bind(this)),this.garage.createGarage(this.currentPage),this.form=new d(["car-form"]),this.form.onSubmit=this.getFormData.bind(this),this.nextPageButton=new r("Next page",[],this.showNext.bind(this)),this.previousPageButton=new r("Previous page",[],this.showPrevious.bind(this)),this.randomCarsButton=new r("Generate random cars",["page__controls_random-cars"],this.createRandomCars.bind(this)),this.timer=new p}async createPage(){const e=new t("div",["page__controls"]),i=new t("div",["page__controls_pagination"]),s=new t("h2",["form-explanation"],"Create new car!");i.insertChilds([this.nextPageButton,this.previousPageButton]),e.insertChilds([this.randomCarsButton,i]),this.root.append(s.getNode(),this.form.getNode(),e.getNode(),this.garage.getNode()),this.popUp=new c(""),this.popUp.onOkClick=this.toggleModal.bind(this),this.modal=new o(this.popUp,this.root),this.toggleModal()}async getCount(){return this.model.getCarsCount(this.currentPage)}startTimer(){this.timer.start(0)}async getFormData(t){this.checkPaginationButtons(),T.createCar(t.name,t.color),this.garage.updateGarage()}async showNext(){this.currentPage+=1,this.garage.updateGarage()}createRandomCars(){T["сreateCars"](),this.garage.updateGarage()}async showPrevious(){this.currentPage-=1,this.garage.updateGarage()}toggleModal(){this.modal.toggleModal()}createWinPopup(e){const i=new t("span",[],e);this.popUp.insertChild(i)}updateGarage(){this.garage.createGarage(this.currentPage)}}class I extends t{constructor(t,e,i,s,n){super("tr",["table__row"]),this.id=t,this.car=new P(e,i),this.wins=s,this.bestTime=n,this.node.innerHTML+=`\n    <td class="table__col">${this.car.getSVGInHTML()}</td>\n    <td class="table__col">${this.car.getName()}</td>\n    <td class="table__col">${this.wins}</td>\n    <td class="table__col">${this.bestTime}</td>`}destroy(){this.node.remove()}}class ${constructor(){this.winners=[]}async getCars(t,e,i){this.winners=[];const s=await v(t,10,e,i);return Promise.all(s.items.map((async t=>new I(t.id,(await b(t.id)).name,(await b(t.id)).color,t.wins,t.time))))}}class L extends t{constructor(t,e){super("th",["table__head"],t),this.onClick=()=>{},this.onClick=e,this.node.onclick=()=>this.onClick?.()}}class U extends t{constructor(e,i){super("table",["table"]),this.body=new t("tbody");const s=new t("thead"),n=new t("tr"),a=[new L("Number"),new L("Car"),new L("Name"),new L("Wins",e),new L("Best time (seconds)",i)];n.insertChilds(a),s.insertChild(n),this.insertChild(s),this.insertChild(this.body)}setRow(t){this.body.insertChild(t)}clearBody(){this.body.getNode().innerHTML=""}}class j extends g{constructor(e){super(),this.paginationLimit=10,this.winSortType="ASC",this.lastChosen=[],this.root=e,this.model=new $,this.currentPage=1,this.winnersTable=new U(this.sortTable.bind(this,"wins"),this.sortTable.bind(this,"time")),this.nextPageButton=new r("Next page",[],this.showNext.bind(this)),this.previousPageButton=new r("Previous page",[],this.showPrevious.bind(this)),this.garageControls=new t("div",["garage__controls"]),this.garageControls.insertChilds([this.nextPageButton,this.previousPageButton])}async getCount(){return parseInt((await v(this.currentPage,this.paginationLimit)).count,10)}async createPage(){this.header=new t("h2",["page__name"],`Winners (${await this.getCount()})`),this.pageNumber=new t("h3",["page__number"],`Page #(${this.currentPage})`),this.root.append(this.header.getNode(),this.pageNumber.getNode()),this.root.prepend(this.garageControls.getNode()),this.updateTable()}async updateTable(){const t=await this.model.getCars(this.currentPage,...this.lastChosen);this.createTableUI(t)}async sortTable(t="id"){const e=await this.getSorted(t);this.createTableUI(e)}createTableUI(e){this.checkPaginationButtons(),this.pageNumber.setContent(`Page #(${this.currentPage})`),this.winnersTable.clearBody(),e.forEach(((e,i)=>{e.insertChildBefore(new t("td",[],(i+1).toString())),this.winnersTable.setRow(e)})),this.root.append(this.winnersTable.getNode())}async getSorted(t){return"ASC"===this.winSortType?(this.winSortType="DESC",this.lastChosen=[t,"ASC"],this.model.getCars(this.currentPage,t,"ASC")):(this.winSortType="ASC",this.lastChosen=[t,"DESC"],this.model.getCars(this.currentPage,t,"DESC"))}async showNext(){this.currentPage+=1,this.updateTable()}async showPrevious(){this.currentPage-=1,this.updateTable()}}class E{constructor(t,e){this.hashChanged=()=>{const t=window.location.hash.length>0?window.location.hash.substr(1):"garage";this.onHashChange&&this.onHashChange(this.routes.find((e=>e.name===t)).controller)},this.onHashChange=e,this.routes=t,window.onhashchange=this.hashChanged,this.hashChanged()}}class R extends t{constructor(){super("div",["app"]),this.menu=new a;const e=new t("header",["header"]);e.insertChild(this.menu),this.insertChild(e),this.appRoot=new t("div",["page"]),this.insertChild(this.appRoot),this.router=new E([{name:"garage",controller:new A(this.getAppRoot())},{name:"winners",controller:new j(this.getAppRoot())}],this.moveToPage.bind(this))}moveToPage(t){this.render(t)}render(t){this.appRoot.getNode().innerHTML="",t.createPage()}getAppRoot(){return this.appRoot.getNode()}}new class{constructor(t){this.root=t,this.controller=new R}start(){this.root.appendChild(this.controller.getNode())}}(document.body).start()})()})();